# Day 5

## Lab - Implementing a custom Terraform Provider using Golang

You need to create a folder
```
mkdir -p ~/go/bin
touch ~/.terraformrc
```

Paste the below code in your ~/.terraformrc file
<pre>
provider_installation {	
    dev_overrides {
    	"registry.terraform.io/tektutor/file" = "/home/student/go/bin",
    }
    direct{}
}  
</pre>

Then you may proceed with the below instructions
```
cd ~/terraform-sep2226-2025
git pull
cd Day5/custom-terraform-providers/
tree
cd file

go mod init github.com/tektutor/terraform-provider-file
go mod tidy
ls -l
go build
ls -l
go install
ls -l
ls -l ~/go/bin
```
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/7a4da1c2-fe2b-4938-b129-88bbd5eac51c" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/5c59e9e3-790e-4d3b-ba9c-b31ab4dde677" />


## Lab - Using our custom teraform file provider in our Terraform project
```
cd ~/terraform-sep2226-2025
git pull
cd Day5/custom-terraform-providers/test-file-custom-terraform-provider
ls -l
terraform plan
terraform apply --auto-approve
ls -l
cat terraform.tfstate
cat myfile.txt
```
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/b577fb44-7d09-47d4-a5b1-619d173e47b0" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/9677dc67-ffc8-4eae-9bb9-2a160bdb1d2b" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/4c3a460f-63d9-48c1-bdd2-64bc116aad7a" />

Now update your main.tf as shown below
<pre>
terraform {
    required_providers {
        localfile = {
		      source = "tektutor/file"
	      }
    }
}

resource "localfile" "myfile" {
   file_name = "./myfile.txt"
   file_content = "Test file revised - generated by terraform."
}    
</pre>

<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/63c38cbc-582c-4cf2-8644-ed8cb4e5f2b7" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/ed060833-cb8b-41a8-b903-886907835fdb" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/15514292-aed1-41fe-a961-c069cda6ccc3" />

Also see if we are able to delete the file provisioned by terraform
```
ls -l
cat myfile.txt
terraform show
terraform destroy --auto-approve
```
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/8c0e2d1b-9465-47c4-a783-1cf576361483" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/523bc9dd-fbbb-48d6-91bf-cddf989e469c" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/bcc19575-a480-4c6c-81b4-017fa7136611" />
